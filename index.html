<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- جلوگیری از کش شدن -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<title>سافت شیراز</title>
<!-- فونت با نسخه‌گذاری -->
<link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/dist/font-face.css?v=3" rel="stylesheet">
<!-- آیکون‌ها با نسخه‌گذاری -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css?v=3">
<style>
/* تمام استایل‌های قبلی شما بدون تغییر */
* { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
body {
    font-family: "Vazirmatn", sans-serif;
    background:#0e0e0f;
    color:#fff;
    overflow-x:hidden;
}
#gold-particles {position:fixed;top:0;left:0;width:100%;height:100%;overflow:hidden;pointer-events:none;z-index:0;}
.particle {position:absolute;width:4px;height:4px;background:rgba(255,215,0,0.8);border-radius:50%;box-shadow:0 0 6px rgba(255,215,0,0.9);animation:floatDown linear infinite;}
@keyframes floatDown {from{transform:translateY(-120vh);opacity:1;}to{transform:translateY(120vh);opacity:0;}}
header {background:rgba(0,0,0,0.5);backdrop-filter:blur(10px);padding:15px 25px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(48,48,48,0.5);position:sticky;top:0;z-index:20;text-shadow:0 0 10px rgba(255,215,0,0.25);}
.logo-fa {font-weight:700;font-size:26px;background:linear-gradient(45deg,#ffd700,#ffb300);-webkit-background-clip:text;color:transparent;}
.hamburger-btn {width:48px;height:42px;display:flex;align-items:center;justify-content:center;background:rgba(26,26,26,0.6);border-radius:10px;border:2px solid rgba(255,215,0,0.25);cursor:pointer;transition:transform .18s, background .18s;color:#ffd700;}
.hamburger-btn:active{transform:scale(.97);}
.hamburger-inner{width:22px;height:16px;position:relative;}
.hamburger-inner span{position:absolute;left:0;right:0;height:2px;background:#ffd700;display:block;border-radius:2px;}
.hamburger-inner span:nth-child(1){top:0;}
.hamburger-inner span:nth-child(2){top:7px;}
.hamburger-inner span:nth-child(3){top:14px;}
#side-menu{position:fixed;top:0;right:0;height:100vh;width:320px;max-width:85%;background:linear-gradient(180deg,rgba(12,12,12,0.98),rgba(20,20,20,0.98));box-shadow:4px 0 30px rgba(0,0,0,0.6);transform:translateX(100%);transition:transform .32s cubic-bezier(.2,.9,.2,1);z-index:30;padding:28px;display:flex;flex-direction:column;gap:18px;direction:rtl;border-right:2px solid rgba(255,215,0,0.12);}
#side-menu.open{transform:translateX(0);}
#menu-close{align-self:flex-start;background:transparent;border:none;color:#ffd700;font-size:20px;cursor:pointer;}
.side-brand{font-weight:800;color:#ffd700;font-size:20px;text-align:right;}
.side-desc{font-size:13px;color:rgba(255,255,255,0.8);text-align:right;}
.side-links{margin-top:6px;display:flex;flex-direction:column;gap:8px;}
.side-links a{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:12px 14px;border-radius:10px;text-decoration:none;color:#fff;font-weight:600;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.03);}
.side-links a:hover{background:rgba(255,215,0,0.06);color:#ffd700;}
#menu-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.55);opacity:0;pointer-events:none;transition:opacity .28s;z-index:25;}
#menu-backdrop.visible{opacity:1;pointer-events:auto;}
main{padding:35px 15px 60px;}
h2{color:#ffd700;font-size:28px;text-align:center;margin-bottom:35px;border-bottom:3px solid #ffd700;display:inline-block;padding-bottom:6px;text-shadow:0 0 8px rgba(255,215,0,0.3);}
.movies-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;justify-items:center;max-width:1200px;margin:0 auto;}
.movie-card{perspective:1000px;position:relative;}
.card-inner{position:relative;width:280px;height:420px;cursor:pointer;transition:transform .35s cubic-bezier(.3,0,.2,1);transform-style:preserve-3d;}
.card-inner.flipped{transform:rotateY(180deg);}
.card-front,.card-back{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:16px;overflow:hidden;backface-visibility:hidden;border:2px solid rgba(255,215,0,0.65);box-shadow:0 0 8px rgba(255,215,0,0.25),inset 0 0 6px rgba(255,215,0,0.2);background:rgba(19,19,20,0.75);backdrop-filter:blur(10px);}
.card-front{display:flex;flex-direction:column;}
.img-bar{flex:1;overflow:hidden;}
.img-bar img{width:100%;height:100%;object-fit:cover;transition:transform .4s;}
.movie-card:hover .img-bar img{transform:scale(1.08);}
.date-bar{height:52px;line-height:52px;padding:0 10px;text-align:center;background:rgba(0,0,0,0.45);color:#ffd700;font-size:19px;font-weight:900;letter-spacing:1.2px;text-shadow:0 0 14px rgba(255,215,0,0.8);}
.date-bar strong{font-size:21px;display:block;transform:translateY(1px);}
.title-bar{height:36px;line-height:36px;padding:0 10px;text-align:center;background:rgba(0,0,0,0.3);border-top:1px solid rgba(255,255,255,0.1);color:#fff;font-weight:600;font-size:15px;}
.reserve-bar{height:36px;line-height:36px;padding:0 10px;text-align:center;background:#ffd700;color:#000;font-weight:bold;cursor:pointer;transition:background .3s;}
.reserve-bar:hover{background:#ffea00;}
.card-back{transform:rotateY(180deg);padding:15px;color:#fff;text-align:right;font-size:14px;display:flex;flex-direction:column;}
.card-back h3,.card-back p strong{color:#ffd700;}
footer{background:rgba(0,0,0,0.5);backdrop-filter:blur(10px);padding:20px;text-align:center;border-top:1px solid rgba(48,48,48,0.5);}
.footer-title{font-size:18px;color:#ffd700;margin-bottom:18px;}
.social-row{display:flex;justify-content:center;gap:18px;}
.social-icon{width:48px;height:48px;border-radius:50%;background:rgba(26,26,26,0.7);backdrop-filter:blur(5px);display:flex;align-items:center;justify-content:center;color:#ffd700;font-size:22px;text-decoration:none;}
.social-icon:hover{background:#ffd700;color:#000;}
#about-popup{display:none;position:fixed;top:-45%;left:50%;transform:translate(-50%,-50%);width:300px;background:rgba(17,17,17,0.95);backdrop-filter:blur(12px);border:2px solid rgba(255,215,0,0.5);border-radius:12px;padding:20px;font-size:14px;text-align:right;z-index:1000;opacity:0;transition:opacity .3s;}
#about-popup.show{display:block;opacity:1;}
#loading-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:#111;display:flex;justify-content:center;align-items:center;z-index:10000;opacity:1;transition:opacity .5s ease;}
#loading-overlay.hidden{opacity:0;pointer-events:none;}
.loader{position:relative;width:40px;height:40px;}
.loader .circle{position:absolute;width:38px;height:38px;opacity:0;transform:rotate(225deg);animation:orbit 5.5s infinite;}
.loader .circle:after{content:'';position:absolute;width:5px;height:5px;border-radius:50%;background:yellow;}
.loader .circle:nth-child(2){animation-delay:240ms;}
.loader .circle:nth-child(3){animation-delay:480ms;}
.loader .circle:nth-child(4){animation-delay:720ms;}
.loader .circle:nth-child(5){animation-delay:960ms;}
@keyframes orbit{
  0%{transform:rotate(225deg);opacity:1;animation-timing-function:ease-out;}
  7%{transform:rotate(345deg);animation-timing-function:linear;}
  30%{transform:rotate(455deg);animation-timing-function:ease-in-out;}
  39%{transform:rotate(690deg);animation-timing-function:linear;}
  70%{transform:rotate(815deg);opacity:1;animation-timing-function:ease-out;}
  75%{transform:rotate(945deg);animation-timing-function:ease-out;}
  76%{transform:rotate(945deg);opacity:0;}
  100%{transform:rotate(945deg);opacity:0;}
}
@media(max-width:1200px){.movies-grid{grid-template-columns:repeat(3,1fr);}}
@media(max-width:768px){.movies-grid{grid-template-columns:repeat(2,1fr);}}
@media(max-width:480px){.movies-grid{grid-template-columns:1fr;}}
</style>
</head>
<body>
<div id="gold-particles"></div>

<div id="loading-overlay">
  <div class="loader">
    <div class="circle"></div><div class="circle"></div><div class="circle"></div><div class="circle"></div><div class="circle"></div>
  </div>
</div>

<header>
  <button class="hamburger-btn" id="hamburger" aria-controls="side-menu" aria-expanded="false" aria-label="باز کردن منو">
    <span class="hamburger-inner" aria-hidden="true"><span></span><span></span><span></span></span>
  </button>
  <div class="logo-fa">Soft Shiraz</div>
</header>

<div id="menu-backdrop" tabindex="-1"></div>

<nav id="side-menu" aria-hidden="true">
  <button id="menu-close" aria-label="بستن منو"><i class="fas fa-times"></i></button>
  <div class="side-brand">Soft Shiraz</div>
  <div class="side-desc">معرفی اکران‌های آینده، رزرو بلیط و اخبار سینما</div>
  <div class="side-links" role="menu">
    <a href="events/events.html" role="menuitem">ایونت‌ کتابخوانی</a>
    <a href="pages/past-releases.html" role="menuitem">اکران‌های شده‌ها</a>
    <a href="https://instagram.com/soft_shiraz" target="_blank" role="menuitem">اینستاگرام ما</a>
    <a href="https://t.me/softshiraz" target="_blank" role="menuitem">تلگرام ما</a>
    <a href="pages/about.html" role="menuitem">درباره ما</a>
    <a href="https://t.me/FLOKI000" role="menuitem">پشتیبانی سایت</a>
  </div>
  <div style="margin-top:auto;font-size:13px;color:rgba(255,255,255,0.8);text-align:right;">نسخه وب — سافت شیراز</div>
</nav>

<main style="padding-top:20px;">
  <section class="section">
    <h2>اکران‌های آینده</h2>
    <div class="movies-grid" id="cards-container"></div>
  </section>
</main>

<footer>
  <div class="footer-title">شبکه‌های اجتماعی سافت شیراز</div>
  <div class="social-row">
    <a class="social-icon" href="https://t.me/softshiraz" target="_blank"><i class="fab fa-telegram"></i></a>
    <a class="social-icon" href="https://instagram.com/soft_shiraz" target="_blank"><i class="fab fa-instagram"></i></a>
    <a class="social-icon" id="about-btn"><i class="fas fa-info"></i></a>
  </div>
  <div id="about-popup">
    <strong>درباره ما:</strong>
    <p>سافت شیراز مرجع معرفی فیلم‌های آینده و اخبار سینما است.</p>
  </div>
</footer>

<script>
// ذرات طلایی
const particleContainer = document.getElementById("gold-particles");
for(let i=0;i<80;i++){
  const p=document.createElement("div");p.className="particle";
  const size=Math.random()*3+2;
  p.style.width=size+"px";p.style.height=size+"px";
  p.style.left=Math.random()*100+"%";
  p.style.top=Math.random()*-100+"vh";
  p.style.animationDuration=Math.random()*4+4+"s";
  p.style.animationDelay=Math.random()*3+"s";
  particleContainer.appendChild(p);
}

// لودر
window.addEventListener('load',()=>{setTimeout(()=>{document.getElementById('loading-overlay').classList.add('hidden');},5000);});

// ---------- بخش جدید: بارگذاری ترتیب از order.json ----------
const container = document.getElementById("cards-container");
let openCard = null;

async function loadCardsByOrder() {
  try {
    // دریافت ترتیب از order.json (با کش ندادن)
    const orderRes = await fetch("cards/order.json?v="+Date.now(), {cache:"no-store"});
    const order = await orderRes.json(); // مثلاً [1,2,3,6,5,4]

    // لود کردن کارت‌ها به همان ترتیب
    for (async ()=>{
      for(const num of order){
        try{
          const res = await fetch(`cards/${num}.html?v=${Date.now()}`, {cache:"no-store"});
          if(!res.ok) continue;
          const html = await res.text();
          const card = document.createElement("div");
          card.className = "movie-card";
          card.innerHTML = html;
          container.appendChild(card);
        }catch(e){console.log("خطا در لود کارت",num);}
      }
    })() );
  } catch(e) {
    console.error("خطا در دریافت order.json",e);
    // اگر فایل ترتیب موجود نبود، به صورت پیش‌فرض 1 تا 150 را لود کن
    for(let i=1;i<=150;i++){
      fetch(`cards/${i}.html?v=${Date.now()}`,{cache:"no-store"})
        .then(r=>r.ok?r.text():"")
        .then(html=>{if(html){
          const card=document.createElement("div");
          card.className="movie-card";
          card.innerHTML=html;
          container.appendChild(card);
        }})
        .catch(()=>{});
    }
  }
}

loadCardsByOrder();

// رزرو بلیط
document.addEventListener("click", function(e) {
  const reserveBtn = e.target.closest(".reserve-bar a");
  if (!reserveBtn) return;
  e.stopPropagation();
  if (reserveBtn.textContent.trim() !== "تهیه بلیط") return;
  const cardFront = reserveBtn.closest(".card-front");
  if (!cardFront) return;
  const movieName = (cardFront.querySelector(".date-bar")?.textContent || "نامشخص").trim();
  const dateTime = (cardFront.querySelector(".title-bar")?.textContent || "نامشخص").trim();
  const message = `سلام وقت بخیر\n\nفیلم : ${movieName}\nزمان : ${dateTime}\n\nممنون میشم شرایط رزرو و موجودی رو اعلام کنید\nمرسی ازتون`;
  const encoded = encodeURIComponent(message);
  window.open(`https://t.me/softshirazadmin?text=${encoded}`, "_blank");
});

// فلیپ کارت
document.addEventListener("click", function(e) {
  if (e.target.closest(".reserve-bar")) return;
  const cardInner = e.target.closest(".card-inner");
  if (cardInner) {
    if (openCard && openCard !== cardInner) openCard.classList.remove("flipped");
    cardInner.classList.toggle("flipped");
    openCard = cardInner.classList.contains("flipped") ? cardInner : null;
  }
});

// درباره ما
const aboutBtn = document.getElementById("about-btn");
const aboutPopup = document.getElementById("about-popup");
aboutBtn.addEventListener("click", e=>{e.stopPropagation();aboutPopup.classList.toggle("show");});
document.addEventListener("click", e=>{if(!aboutPopup.contains(e.target) && e.target!==aboutBtn) aboutPopup.classList.remove("show");});

// منوی همبرگری (بدون تغییر)
const hamburger=document.getElementById('hamburger'),sideMenu=document.getElementById('side-menu'),backdrop=document.getElementById('menu-backdrop'),menuClose=document.getElementById('menu-close');
function openMenu(){sideMenu.classList.add('open');backdrop.classList.add('visible');hamburger.setAttribute('aria-expanded','true');sideMenu.setAttribute('aria-hidden','false');}
function closeMenu(){sideMenu.classList.remove('open');backdrop.classList.remove('visible');hamburger.setAttribute('aria-expanded','false');sideMenu.setAttribute('aria-hidden','true');hamburger.focus();}
hamburger.addEventListener('click',e=>{e.stopPropagation();hamburger.getAttribute('aria-expanded')==='true'?closeMenu():openMenu();});
menuClose.addEventListener('click',e=>{e.stopPropagation();closeMenu();});
backdrop.addEventListener('click',closeMenu);
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeMenu();});
sideMenu.addEventListener('click',e=>e.stopPropagation());
</script>
</body>
</html>
